---
layout: default
title: Url search
permalink: /sitemap-search/
nonav: true
---


<div class="url-search container-sm mt-3 mb-3 pt-5 pb-5 text-center">
  <div class="row align-items-start">
    <div class="col">
      <h2>Url Search</h2>
    </div>
  </div>
  <div class="row">

    <div class="col-sm-12 form-group mt-3 py-2">
      <label class="pt-2" for="sitemap">Enter a sitemap here:</label>
      <textarea class="form-control form-control-lg" id="sitemap" rows="5"
        placeholder=""></textarea>
    </div>

    <div class="col-sm-12 col-md-6 mt-3">
      <label class="pt-2" for="delay-time">Select delay (in seconds) before searching the page:</label><br>
      <select class="form-select mt-3" aria-label="Delay search after loading page" id="delay-time">
          <option value="0">No Delay</option>
          <option value="1">1 Second</option>
          <option value="3">3 Seconds</option>
          <option value="5">5 Seconds</option>
          <option value="10">10 Seconds</option>
          <option value="15">15 Seconds</option>
          <option value="20">20 Seconds</option>
      </select>
    </div>

    <div class="col-sm-12 col-md-6 mt-3">
      <label class="pt-2" for="limit-pages">Limit the number of pages to search:</label>
      <select class="form-select mt-3" aria-label="Limit page loads" id="limit-pages">
          <option value="all">All</option>
          <option value="1">1</option>
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
      </select>
    </div>

    <div class="col-sm-12 form-group mt-3 py-2">
      <label class="pt-2" for="regex-input">Enter your Regular Expression:</label>
      <input class="form-control form-control-lg" type="text" id="regex-input" placeholder="e.g. \bTest\b">
    </div>

    <div class="col-sm-12 form-group mt-3 py-2">
      <button class="btn btn-secondary" onclick="startMatching()">Start Matching</button>
    </div>

    <div class="col-sm-12 form-group mt-3 py-2">
      <div id="results"></div>
    </div>

    <div class="col-sm-12 form-group mt-3 py-2">
      <iframe style="height: 500px; width: 100%;" id="iframe-loader"></iframe>
    </div>

  </div>
</div>

<script>
  function startMatching() {
    const siteMap = document.getElementById('sitemap').value;
    const regexInput = document.getElementById('regex-input').value;
    const resultsDiv = document.getElementById('results');
    const iframe = document.getElementById('iframe-loader');
    const limitPages = document.getElementById('limit-pages').value;
    const delayTime = document.getElementById('delay-time').value * 1000; // Convert seconds to milliseconds

    resultsDiv.innerHTML = '';

    if (!siteMap.trim() || !regexInput.trim()) {
      resultsDiv.innerHTML = '<p class="loading">Please provide both Sitemap and a regex pattern.</p>';
      return;
    }

    const urls = extractUrls();

    let limitedUrls = urls;
    if (limitPages !== 'all') {
      limitedUrls = urls.slice(0, parseInt(limitPages, 10));
    }

    let regex;
    try {
      regex = new RegExp(regexInput);
    } catch (e) {
      resultsDiv.innerHTML = '<p class="loading">Invalid regular expression.</p>';
      return;
    }

    let currentIndex = 0;

    function loadNextUrl() {
      if (currentIndex >= limitedUrls.length) {
        resultsDiv.innerHTML += '<p class="loading">All URLs processed.</p>';
        iframe.style.display = 'none';
        return;
      }

      const currentUrl = limitedUrls[currentIndex];
      resultsDiv.innerHTML += `<p class="loading">Loading: ${currentUrl}</p>`;
      iframe.src = currentUrl;
      iframe.style.display = 'block';

      iframe.onload = () => {

        setTimeout(() => {
          const bodyText = iframe.contentWindow.document.body.innerHTML;
          const matches = bodyText.match(regex);

          if (matches && matches.length > 0) {
            resultsDiv.innerHTML += `<p>Matches found on ${currentUrl}: ${matches.join(', ')}</p>`;
          } else {
            resultsDiv.innerHTML += `<p>No matches found on ${currentUrl}.</p>`;
          }

          currentIndex++;
          loadNextUrl();
        }, delayTime);
      };

      iframe.onerror = () => {
        resultsDiv.innerHTML += `<p>Error loading ${currentUrl}. Skipping...</p>`;
        currentIndex++;
        loadNextUrl();
      };
    }

    loadNextUrl();
  }

  function extractUrls() {
    const sitemap = document.getElementById('sitemap').value.trim();
    const resultsDiv = document.getElementById('results');
    resultsDiv.textContent = '';

    let parser = new DOMParser();
    let xmlDoc;
    let urls = [];

    try {
        xmlDoc = parser.parseFromString(sitemap, "application/xml");
        
        if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
            resultsDiv.textContent = "Error parsing the XML. Please check the content.";
            return;
        }
        
        const locTags = xmlDoc.getElementsByTagName('loc');
        
        for (let i = 0; i < locTags.length; i++) {
            urls.push(locTags[i].textContent);
        }

        resultsDiv.textContent = urls.length > 0 ? urls.join('\n') : "No URLs found.";
    } catch (error) {
        resultsDiv.textContent = "Error processing XML. Please provide valid XML content.";
    }

    return urls;
}
</script>